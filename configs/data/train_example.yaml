_target_: src.data.datamodule.ProteinDataMixture

dataset_builders:
  foldseek_s50:
    _target_: src.data.builders.family_text_memmap_datasets.ProteinFamilyMemmapDataset
    name: foldseek_s50
    dataset_root: ${paths.root_dir}/data/train_example/foldseek_s50
    tokenizer: ${tokenizer}
    preprocessor:
      _target_: src.data.processors.ProteinDocumentPreprocessor
      cfg:
        _target_: src.data.processors.PreprocessingConfig
        document_token: "[RAW]"
        drop_first_protein: false
        keep_first_protein: false
        allow_unk: false
        max_tokens_per_example: 2048
        shuffle_proteins_in_document: true
        padding: do_not_pad
      transform_fns: null
    sample_cache_size: 64
    max_tokens_per_family: 4096
    shuffle_family_sequences: true
    seed: ${seed}

  uniref90:
    _target_: src.data.builders.family_text_memmap_datasets.ProteinFamilyMemmapDataset
    name: uniref90
    dataset_root: ${paths.root_dir}/data/train_example/uniref90
    tokenizer: ${tokenizer}
    preprocessor:
      _target_: src.data.processors.ProteinDocumentPreprocessor
      cfg:
        _target_: src.data.processors.PreprocessingConfig
        document_token: "[RAW]"
        drop_first_protein: false
        keep_first_protein: false
        allow_unk: false
        max_tokens_per_example: 2048
        shuffle_proteins_in_document: true
        padding: do_not_pad
      transform_fns: null
    sample_cache_size: 64
    max_tokens_per_family: 4096
    shuffle_family_sequences: true
    seed: ${seed}

  openfold_openproteinset:
    _target_: src.data.builders.family_text_memmap_datasets.ProteinFamilyMemmapDataset
    name: openfold_openproteinset
    dataset_root: ${paths.root_dir}/data/train_example/OpenFold_OpenProteinSet
    tokenizer: ${tokenizer}
    preprocessor:
      _target_: src.data.processors.ProteinDocumentPreprocessor
      cfg:
        _target_: src.data.processors.AlignedProteinPreprocessingConfig
        document_token: "[RAW]"
        drop_first_protein: false
        keep_first_protein: false
        allow_unk: false
        max_tokens_per_example: 2048
        shuffle_proteins_in_document: true
        padding: do_not_pad
        keep_insertions: true
        to_upper: true
        keep_gaps: false
        use_msa_pos: false
      transform_fns: null
    sample_cache_size: 64
    max_tokens_per_family: 4096
    shuffle_family_sequences: true
    seed: ${seed}

  ted:
    _target_: src.data.builders.family_text_memmap_datasets.ProteinFamilyMemmapDataset
    name: ted
    dataset_root: ${paths.root_dir}/data/train_example/ted
    tokenizer: ${tokenizer}
    preprocessor:
      _target_: src.data.processors.ProteinDocumentPreprocessor
      cfg:
        _target_: src.data.processors.PreprocessingConfig
        document_token: "[RAW]"
        drop_first_protein: false
        keep_first_protein: false
        allow_unk: false
        max_tokens_per_example: 2048
        shuffle_proteins_in_document: true
        padding: do_not_pad
      transform_fns: null
    sample_cache_size: 64
    max_tokens_per_family: 4096
    shuffle_family_sequences: true
    seed: ${seed}

data_weights:
  foldseek_s50: 1
  uniref90: 1
  openfold_openproteinset: 1
  ted: 1

val_dataset_batch_sizes: {}

batch_size: 4
data_dir: ${paths.data_dir}
num_workers: 0
ignore_gaps: true
feature_names: ${constants.sequence_features}
pack_to_max_tokens: 12000
prefetch_factor: null
shuffle: true
interleaved: true
interleaved_block_size: 64
